function RunModifiedEulerGen
%In rotating reference frame (SImulink model)
%Given machine parameters
Rs = 0.01524;
Ll = 0.01524;
Lmd = 2.81;
Lmq = 1.64;
Rfd = 0.004319;
Llfd = 0.531;
Rkd = 0.2343;
Llkd = 2.655;
Rkq1 = 0.03365;
Llkq1 = 0.2408;
H = 0.3222;
F = 0.01322;

%Calculated machine parameters
Ld = Ll + Lmd;
Lq = Ll + Lmq;
Lfd = Llfd + Lmd;
Lkd = Llkd + Lmd;
Lkq1 = Llkq1 + Lmq;
Lkq2 = Llkq1 + Lmq;
Rkq2 = 0.03365;


%Network reference frame stator terminal voltages
% V_d = 1;
% V_q = 0;
PL = 0.8; dPL = 0.000;
%Pm = 0.8;%Input mechanical power
V_fd = 0.001;%Input field excitation
wb = 377;omega_b = wb; omega_s = 1;
omega0 = 1;
dV_ddt = 0.0001; 
omega_0 = 1;
t0 = [0;2];
x0 =  [  -0.9691    0.4975    0.8659    0.0202    0.0369    0.0369    0.9576    1.0056];
x0(8) = 1; x0(9:10) = [0.01 PL];
tic

tspan = [0,0.001]; %x0 = [zeros(7,1);1];
[t1,x1] = ode45(@RunDynamics,tspan,x0);

%Explicit method starts
t0 = tspan(1);tend = tspan(2);
x=transpose(x0);t = t0; h=1e-7;
while t<=tend
    xnew = x(:,end) + h*RunDynamics(t,x(:,end));
    Fin = x(:,end) + (h/2)*(RunDynamics(t,x(:,end)) + RunDynamics(t,xnew));
    x = [x Fin];
    t = t+h
end
    
function dx = RunDynamics(t,x)
%Rotor reference frame quantities
i_d = x(1);
i_q = x(2);
i_fd = x(3);
i_kd = x(4);
i_kq1 = x(5);
i_kq2 = x(6);
delta = x(7);
omega = x(8);
V_q = x(9);
PL = x(10);
%Transformation matrix (from network to machine)
Tn2m = [sin(delta) cos(delta);
    -cos(delta)  sin(delta)];
Tm2n = [sin(delta) -cos(delta);
    cos(delta)  sin(delta)];

t
Inet = Tm2n*[i_d;i_q]; I_d = Inet(1); I_q = Inet(2);
V_d = (PL - I_q*V_q)/I_d;
Vm = 1.2;%%PL/(e_fd*sin(delta));
dV_ddt = 0.00;%-Vm*sin(atan(V_q/V_d))*omega0; 
%V_q = sqrt(Vm^2 - V_d^2);
%stator terminal voltages in rotating reference
V_mach = Tn2m*[V_d;V_q]; v_d = V_mach(1); v_q = V_mach(2);
Pm = PL;% + 2*H*(omega-omega0);
%Current vector in machine reference
I = [i_d;i_q;i_fd; i_kd;i_kq1; i_kq2];
    %i_d i_q i_fd i_kd i_kq1 i_kq2
L = [Ld   0   Lmd  Lmd   0     0;
      0   Lq   0    0    Lmq   Lmq;
      Lmd 0    Lfd  Lmd   0     0
      Lmd 0    Lmd  Lkd   0     0
      0   Lmq  0    0     Lkq1  Lmq
      0   Lmq  0    0     Lmq     Lkq2];
%Flux linkages
psi = L*I;
V_kd =0; V_kq1 = 0; V_kq2 =0;
R = diag([Rs;Rs;Rfd;Rkd;Rkq1; Rkq2]);
V = [v_d; v_q; V_fd; V_kd; V_kq1; V_kq2];

ohm = [0 -omega 0 0 0 0;
       omega 0 0 0 0 0;
       zeros(4,6)];
%Flux derivatives
dpsidt =  [V -  R*I - ohm*psi];
%Current derivatives
dIdt = wb*(L\ dpsidt);
%Electromagnetic torque
% Te = (psi(1)*I(2) - psi(2)*I(1));
Te = (v_d*i_d + v_q*i_q);
% plot(t,Te,'b*'); hold on;
%Mechanical state spance
ddeltadt = wb*(omega-omega0);
domegadt = (Pm/omega -Te)/(2*H);
dV_qdt = (I_d^2*Ll^2*Llfd*Llkd*Llkq1*dPL*cos(delta)^2 + I_d^2*Ll^2*Llfd*Llkq1*Lmd*dPL*cos(delta)^2 + I_d^2*Ll^2*Llkd*Llkq1*Lmd*dPL*cos(delta)^2 + 2*I_d^2*Ll^2*Llfd*Llkd*Lmq*dPL*cos(delta)^2 + 2*I_d^2*Ll^2*Llfd*Lmd*Lmq*dPL*cos(delta)^2 + 2*I_d^2*Ll^2*Llkd*Lmd*Lmq*dPL*cos(delta)^2 - I_d^3*Ll^2*Llfd*Llkd*Llkq1*dV_ddt*cos(delta)^2 - I_d^3*Ll^2*Llfd*Llkq1*Lmd*dV_ddt*cos(delta)^2 - I_d^3*Ll^2*Llkd*Llkq1*Lmd*dV_ddt*cos(delta)^2 - 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*dV_ddt*cos(delta)^2 - 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*dV_ddt*cos(delta)^2 - 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*dV_ddt*cos(delta)^2 + I_d^2*Ll^2*Llfd*Llkd*Llkq1*dPL*sin(delta)^2 + I_d^2*Ll^2*Llfd*Llkq1*Lmd*dPL*sin(delta)^2 + I_d^2*Ll^2*Llkd*Llkq1*Lmd*dPL*sin(delta)^2 + 2*I_d^2*Ll^2*Llfd*Llkd*Lmq*dPL*sin(delta)^2 + 2*I_d^2*Ll^2*Llfd*Lmd*Lmq*dPL*sin(delta)^2 + 2*I_d^2*Ll^2*Llkd*Lmd*Lmq*dPL*sin(delta)^2 - I_d^3*Ll^2*Llfd*Llkd*Llkq1*dV_ddt*sin(delta)^2 - I_d^3*Ll^2*Llfd*Llkq1*Lmd*dV_ddt*sin(delta)^2 - I_d^3*Ll^2*Llkd*Llkq1*Lmd*dV_ddt*sin(delta)^2 - 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*dV_ddt*sin(delta)^2 - 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*dV_ddt*sin(delta)^2 - 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*dV_ddt*sin(delta)^2 - Ll*Llfd*Llkd*Llkq1*PL^2*omega_b^2*cos(delta)^2 - Ll*Llfd*Llkq1*Lmd*PL^2*omega_b^2*cos(delta)^2 - Ll*Llkd*Llkq1*Lmd*PL^2*omega_b^2*cos(delta)^2 - 2*Ll*Llfd*Llkd*Lmq*PL^2*omega_b^2*cos(delta)^2 - Llfd*Llkd*Llkq1*Lmd*PL^2*omega_b^2*cos(delta)^2 - 2*Ll*Llfd*Lmd*Lmq*PL^2*omega_b^2*cos(delta)^2 - 2*Ll*Llkd*Lmd*Lmq*PL^2*omega_b^2*cos(delta)^2 - 2*Llfd*Llkd*Lmd*Lmq*PL^2*omega_b^2*cos(delta)^2 - Ll*Llfd*Llkd*Llkq1*PL^2*omega_b^2*sin(delta)^2 - Ll*Llfd*Llkq1*Lmd*PL^2*omega_b^2*sin(delta)^2 - Ll*Llkd*Llkq1*Lmd*PL^2*omega_b^2*sin(delta)^2 - 2*Ll*Llfd*Llkd*Lmq*PL^2*omega_b^2*sin(delta)^2 - Llfd*Llkd*Llkq1*Lmq*PL^2*omega_b^2*sin(delta)^2 - 2*Ll*Llfd*Lmd*Lmq*PL^2*omega_b^2*sin(delta)^2 - 2*Ll*Llkd*Lmd*Lmq*PL^2*omega_b^2*sin(delta)^2 - Llfd*Llkq1*Lmd*Lmq*PL^2*omega_b^2*sin(delta)^2 - Llkd*Llkq1*Lmd*Lmq*PL^2*omega_b^2*sin(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmd*dPL*cos(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmq*dPL*cos(delta)^2 + 2*I_d^2*Ll*Llfd*Llkd*Lmd*Lmq*dPL*cos(delta)^2 + I_d^2*Ll*Llfd*Llkq1*Lmd*Lmq*dPL*cos(delta)^2 + I_d^2*Ll*Llkd*Llkq1*Lmd*Lmq*dPL*cos(delta)^2 + I_d^2*Llfd*Llkd*Llkq1*Lmd*Lmq*dPL*cos(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*dV_ddt*cos(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*dV_ddt*cos(delta)^2 - 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*dV_ddt*cos(delta)^2 - I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*dV_ddt*cos(delta)^2 - I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*dV_ddt*cos(delta)^2 - I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*dV_ddt*cos(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmd*dPL*sin(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmq*dPL*sin(delta)^2 + 2*I_d^2*Ll*Llfd*Llkd*Lmd*Lmq*dPL*sin(delta)^2 + I_d^2*Ll*Llfd*Llkq1*Lmd*Lmq*dPL*sin(delta)^2 + I_d^2*Ll*Llkd*Llkq1*Lmd*Lmq*dPL*sin(delta)^2 + I_d^2*Llfd*Llkd*Llkq1*Lmd*Lmq*dPL*sin(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*dV_ddt*sin(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*dV_ddt*sin(delta)^2 - 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*dV_ddt*sin(delta)^2 - I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*dV_ddt*sin(delta)^2 - I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*dV_ddt*sin(delta)^2 - I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*dV_ddt*sin(delta)^2 - I_d^2*Ll*Llfd*Llkd*Llkq1*V_q^2*omega_b^2*cos(delta)^2 - I_q^2*Ll*Llfd*Llkd*Llkq1*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Ll*Llfd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Ll*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)^2 - 2*I_d^2*Ll*Llfd*Llkd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_q^2*Ll*Llfd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)^2 - I_q^2*Ll*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)^2 - 2*I_q^2*Ll*Llfd*Llkd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Llfd*Llkd*Llkq1*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_q^2*Llfd*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)^2 - 2*I_d^2*Ll*Llfd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - 2*I_d^2*Ll*Llkd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - 2*I_q^2*Ll*Llfd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - 2*I_q^2*Ll*Llkd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Llfd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Llkd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - 2*I_q^2*Llfd*Llkd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)^2 - I_d^2*Ll*Llfd*Llkd*Llkq1*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Ll*Llfd*Llkd*Llkq1*V_q^2*omega_b^2*sin(delta)^2 - I_d^2*Ll*Llfd*Llkq1*Lmd*V_q^2*omega_b^2*sin(delta)^2 - I_d^2*Ll*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*sin(delta)^2 - 2*I_d^2*Ll*Llfd*Llkd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Ll*Llfd*Llkq1*Lmd*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Ll*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*sin(delta)^2 - 2*I_q^2*Ll*Llfd*Llkd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - I_d^2*Llfd*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Llfd*Llkd*Llkq1*Lmq*V_q^2*omega_b^2*sin(delta)^2 - 2*I_d^2*Ll*Llfd*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - 2*I_d^2*Ll*Llkd*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - 2*I_q^2*Ll*Llfd*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - 2*I_q^2*Ll*Llkd*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - 2*I_d^2*Llfd*Llkd*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Llfd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 - I_q^2*Llkd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*sin(delta)^2 + I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega_b*omega_s*sin(delta)^2 + I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d*Ll*Llkd*Llkq1*Lmd*PL*V_fd*omega_b^2*sin(delta) + 2*I_d*Ll*Llkd*Lmd*Lmq*PL*V_fd*omega_b^2*sin(delta) + I_d*Llkd*Llkq1*Lmd*Lmq*PL*V_fd*omega_b^2*sin(delta) + I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll*Llfd*Llkd*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Llfd*Llkd*Llkq1*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll*Llfd*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll*Llkd*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Llfd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Llkd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)^2 + I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b^2*sin(delta)^2 + I_d^3*Ll*Llfd*Llkq1*Lmd^2*V_q*omega*omega_b^2*sin(delta)^2 + I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b^2*sin(delta)^2 + I_d^3*Ll*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*sin(delta)^2 + I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + I_d^3*Llfd*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Ll*Llfd*Lmd^2*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Ll*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d^3*Llfd*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_q*Ll*Llfd*Llkd*Llkq1*PL*V_q*omega_b^2*cos(delta)^2 + 2*I_q*Ll*Llfd*Llkq1*Lmd*PL*V_q*omega_b^2*cos(delta)^2 + 2*I_q*Ll*Llkd*Llkq1*Lmd*PL*V_q*omega_b^2*cos(delta)^2 + 4*I_q*Ll*Llfd*Llkd*Lmq*PL*V_q*omega_b^2*cos(delta)^2 + 2*I_q*Llfd*Llkd*Llkq1*Lmd*PL*V_q*omega_b^2*cos(delta)^2 + 4*I_q*Ll*Llfd*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)^2 + 4*I_q*Ll*Llkd*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)^2 + 4*I_q*Llfd*Llkd*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)^2 + I_d^2*Ll*Llkd*Llkq1*Lmd*V_fd*V_q*omega_b^2*cos(delta) + 2*I_d^2*Ll*Llkd*Lmd*Lmq*V_fd*V_q*omega_b^2*cos(delta) + I_d^2*Llkd*Llkq1*Lmd*Lmq*V_fd*V_q*omega_b^2*cos(delta) + 2*I_q*Ll*Llfd*Llkd*Llkq1*PL*V_q*omega_b^2*sin(delta)^2 + 2*I_q*Ll*Llfd*Llkq1*Lmd*PL*V_q*omega_b^2*sin(delta)^2 + 2*I_q*Ll*Llkd*Llkq1*Lmd*PL*V_q*omega_b^2*sin(delta)^2 + 4*I_q*Ll*Llfd*Llkd*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + 2*I_q*Llfd*Llkd*Llkq1*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + 4*I_q*Ll*Llfd*Lmd*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + 4*I_q*Ll*Llkd*Lmd*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + 2*I_q*Llfd*Llkq1*Lmd*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + 2*I_q*Llkd*Llkq1*Lmd*Lmq*PL*V_q*omega_b^2*sin(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*PL*Rs*omega_b^2*cos(delta)^2 + I_d^2*Ll*Llfd*Llkq1*Lmd*PL*Rs*omega_b^2*cos(delta)^2 + I_d^2*Ll*Llkd*Llkq1*Lmd*PL*Rs*omega_b^2*cos(delta)^2 + 2*I_d^2*Ll*Llfd*Llkd*Lmq*PL*Rs*omega_b^2*cos(delta)^2 + I_d^2*Llfd*Llkd*Llkq1*Lmd*PL*Rs*omega_b^2*cos(delta)^2 + 2*I_d^2*Ll*Llfd*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)^2 + 2*I_d^2*Ll*Llkd*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)^2 + 2*I_d^2*Llfd*Llkd*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)^2 + I_d^2*Ll*Llfd*Llkd*Llkq1*PL*Rs*omega_b^2*sin(delta)^2 + I_d^2*Ll*Llfd*Llkq1*Lmd*PL*Rs*omega_b^2*sin(delta)^2 + I_d^2*Ll*Llkd*Llkq1*Lmd*PL*Rs*omega_b^2*sin(delta)^2 + 2*I_d^2*Ll*Llfd*Llkd*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + I_d^2*Llfd*Llkd*Llkq1*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + 2*I_d^2*Ll*Llfd*Lmd*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + 2*I_d^2*Ll*Llkd*Lmd*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + I_d^2*Llfd*Llkq1*Lmd*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + I_d^2*Llkd*Llkq1*Lmd*Lmq*PL*Rs*omega_b^2*sin(delta)^2 + I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll^2*Llfd*Llkd*Llkq1*V_q*omega_b*omega_s*cos(delta)^2 + I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll^2*Llfd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll^2*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d^3*Ll^2*Llfd*Llkd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d^3*Ll^2*Llfd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d^3*Ll^2*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 - 2*I_d*Ll*Llfd*Llkd*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - 2*I_d*Ll*Llfd*Llkd*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d*Llfd*Llkd*Llkq1*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Llfd*Llkd*Llkq1*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - 2*I_d*Ll*Llfd*Lmd*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - 2*I_d*Ll*Llfd*Lmd*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - 2*I_d*Ll*Llkd*Lmd*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - 2*I_d*Ll*Llkd*Lmd*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d*Llfd*Llkq1*Lmd*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Llfd*Llkq1*Lmd*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d*Llkd*Llkq1*Lmd*Lmq^2*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Llkd*Llkq1*Lmd*Lmq^2*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d^2*I_q*Llfd*Llkd*Llkq1*Lmd*Rs*V_q*omega_b^2*cos(delta)^2 + I_d^2*I_q*Llfd*Llkd*Llkq1*Lmq*Rs*V_q*omega_b^2*cos(delta)^2 - 2*I_d^2*I_q*Llfd*Llkd*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)^2 + I_d^2*I_q*Llfd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)^2 + I_d^2*I_q*Llkd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)^2 + I_d^2*I_q*Llfd*Llkd*Llkq1*Lmd*Rs*V_q*omega_b^2*sin(delta)^2 - I_d^2*I_q*Llfd*Llkd*Llkq1*Lmq*Rs*V_q*omega_b^2*sin(delta)^2 + 2*I_d^2*I_q*Llfd*Llkd*Lmd*Lmq*Rs*V_q*omega_b^2*sin(delta)^2 - I_d^2*I_q*Llfd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*sin(delta)^2 - I_d^2*I_q*Llkd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*sin(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega*omega_b^2*cos(delta)^2 - I_d*I_q*Ll*Llfd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega*omega_b^2*cos(delta)^2 - I_d*I_q*Ll*Llkd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)^2 - I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega*omega_b^2*cos(delta)^2 - I_d*I_q*Llfd*Llkd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Ll*Llfd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Ll*Llkd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Llfd*Llkd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega_b*omega_s*cos(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 - 2*I_d*I_q*Llfd*Llkd*Llkq1*Lmd*V_q^2*omega_b^2*cos(delta)*sin(delta) + 2*I_d*I_q*Llfd*Llkd*Llkq1*Lmq*V_q^2*omega_b^2*cos(delta)*sin(delta) - 4*I_d*I_q*Llfd*Llkd*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)*sin(delta) + 2*I_d*I_q*Llfd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)*sin(delta) + 2*I_d*I_q*Llkd*Llkq1*Lmd*Lmq*V_q^2*omega_b^2*cos(delta)*sin(delta) - I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega*omega_b^2*sin(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega*omega_b^2*sin(delta)^2 - I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll*Llfd*Llkd*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega*omega_b^2*sin(delta)^2 - I_d*I_q*Llfd*Llkd*Llkq1*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll*Llfd*Lmd*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll*Llkd*Lmd*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega*omega_b^2*sin(delta)^2 - I_d*I_q*Llfd*Llkq1*Lmd*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 - I_d*I_q*Llkd*Llkq1*Lmd*Lmq^2*PL*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 - I_d^3*Llfd*Llkd*Llkq1*Lmd*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + I_d^3*Llfd*Llkd*Llkq1*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) - 2*I_d^3*Llfd*Llkd*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + I_d^3*Llfd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + I_d^3*Llkd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + 2*I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*sin(delta)^2 + 4*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 - 2*I_d^2*Ll*Llfd*Llkd*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llfd*Llkd*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) - I_d^2*Llfd*Llkd*Llkq1*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Llfd*Llkd*Llkq1*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llfd*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llfd*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llkd*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llkd*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) - I_d^2*Llfd*Llkq1*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Llfd*Llkq1*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) - I_d^2*Llkd*Llkq1*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Llkd*Llkq1*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*cos(delta) + I_d^2*Ll*Llfd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*sin(delta) + I_d^2*Ll*Llfd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*sin(delta) + I_d^2*Ll*Llkd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*sin(delta) + I_d^2*Ll*Llkd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*sin(delta) + I_d^2*Llfd*Llkd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*sin(delta) + I_d^2*Llfd*Llkd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llfd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llfd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llkd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llkd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*sin(delta) + 2*I_d^2*Llfd*Llkd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*sin(delta) + 2*I_d^2*Llfd*Llkd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*sin(delta) - I_d*I_q*Ll*Llkd*Llkq1*Lmd*V_fd*V_q*omega_b^2*sin(delta) - 2*I_d*I_q*Ll*Llkd*Lmd*Lmq*V_fd*V_q*omega_b^2*sin(delta) - I_d*I_q*Llkd*Llkq1*Lmd*Lmq*V_fd*V_q*omega_b^2*sin(delta) + I_d*Ll*Llfd*Llkd*Lmq*PL*Rkq1*i_kq1*omega_b^2*cos(delta) + I_d*Ll*Llfd*Llkd*Lmq*PL*Rkq2*i_kq2*omega_b^2*cos(delta) + I_d*Ll*Llfd*Lmd*Lmq*PL*Rkq1*i_kq1*omega_b^2*cos(delta) + I_d*Ll*Llfd*Lmd*Lmq*PL*Rkq2*i_kq2*omega_b^2*cos(delta) + I_d*Ll*Llkd*Lmd*Lmq*PL*Rkq1*i_kq1*omega_b^2*cos(delta) + I_d*Ll*Llkd*Lmd*Lmq*PL*Rkq2*i_kq2*omega_b^2*cos(delta) + I_d*Llfd*Llkd*Lmd*Lmq*PL*Rkq1*i_kq1*omega_b^2*cos(delta) + I_d*Llfd*Llkd*Lmd*Lmq*PL*Rkq2*i_kq2*omega_b^2*cos(delta) - I_d*Ll*Llkd*Llkq1*Lmd*PL*Rfd*i_fd*omega_b^2*sin(delta) - 2*I_d*Ll*Llkd*Lmd*Lmq*PL*Rfd*i_fd*omega_b^2*sin(delta) - I_d*Llkd*Llkq1*Lmd*Lmq*PL*Rfd*i_fd*omega_b^2*sin(delta) - I_d*Ll*Llfd*Llkq1*Lmd*PL*Rkd*i_kd*omega_b^2*sin(delta) - 2*I_d*Ll*Llfd*Lmd*Lmq*PL*Rkd*i_kd*omega_b^2*sin(delta) - I_d*Llfd*Llkq1*Lmd*Lmq*PL*Rkd*i_kd*omega_b^2*sin(delta) + I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Ll*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + 2*I_d*I_q^2*Llfd*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkd*Llkq1*V_q*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Ll^2*Llfd*Llkq1*Lmd*V_q*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Ll^2*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Llkd*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Llkd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Llfd*Llkd*Llkq1*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Lmd*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llfd*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llkd*Lmd*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll^2*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Llfd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Llkd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*sin(delta)^2 - I_d^2*Ll*Llfd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)*sin(delta) - I_d^2*Ll*Llkd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llfd*Llkd*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) - I_d^2*Llfd*Llkd*Llkq1*Lmd^2*PL*omega*omega_b^2*cos(delta)*sin(delta) + I_d^2*Llfd*Llkd*Llkq1*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llfd*Lmd*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*Ll*Llfd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llkd*Lmd*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*Ll*Llkd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*Llfd*Llkd*Lmd^2*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) + I_d^2*Llfd*Llkq1*Lmd*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) + I_d^2*Llkd*Llkq1*Lmd*Lmq^2*PL*omega*omega_b^2*cos(delta)*sin(delta) - I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega_b*omega_s*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega*omega_b*cos(delta)^2 + 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 + 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 + 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - I_d^2*Ll*Llkd*Llkq1*Lmd*Rfd*V_q*i_fd*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llkd*Lmd*Lmq*Rfd*V_q*i_fd*omega_b^2*cos(delta) - I_d^2*Llkd*Llkq1*Lmd*Lmq*Rfd*V_q*i_fd*omega_b^2*cos(delta) - I_d^2*Ll*Llfd*Llkq1*Lmd*Rkd*V_q*i_kd*omega_b^2*cos(delta) - 2*I_d^2*Ll*Llfd*Lmd*Lmq*Rkd*V_q*i_kd*omega_b^2*cos(delta) - I_d^2*Llfd*Llkq1*Lmd*Lmq*Rkd*V_q*i_kd*omega_b^2*cos(delta) + I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 + I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 - I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll^2*Llfd*Llkd*Llkq1*PL*omega_b*omega_s*sin(delta)^2 - I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll^2*Llfd*Llkq1*Lmd*PL*omega_b*omega_s*sin(delta)^2 - I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll^2*Llkd*Llkq1*Lmd*PL*omega_b*omega_s*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega*omega_b*sin(delta)^2 + 2*I_d*I_q*Ll^2*Llfd*Llkd*Lmq*PL*omega_b*omega_s*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 + 2*I_d*I_q*Ll^2*Llfd*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 - 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 + 2*I_d*I_q*Ll^2*Llkd*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 + 2*I_d*Llfd*Llkd*Llkq1*Lmd*PL*V_q*omega_b^2*cos(delta)*sin(delta) - 2*I_d*Llfd*Llkd*Llkq1*Lmq*PL*V_q*omega_b^2*cos(delta)*sin(delta) + 4*I_d*Llfd*Llkd*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)*sin(delta) - 2*I_d*Llfd*Llkq1*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)*sin(delta) - 2*I_d*Llkd*Llkq1*Lmd*Lmq*PL*V_q*omega_b^2*cos(delta)*sin(delta) - I_d^2*Ll*Llfd*Llkd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*sin(delta) - I_d^2*Ll*Llfd*Llkd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*sin(delta) - I_d^2*Ll*Llfd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*sin(delta) - I_d^2*Ll*Llfd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*sin(delta) - I_d^2*Ll*Llkd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*sin(delta) - I_d^2*Ll*Llkd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*sin(delta) - I_d^2*Llfd*Llkd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*sin(delta) - I_d^2*Llfd*Llkd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*sin(delta) + I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 + I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d^3*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 - I_d^3*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d^3*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 - I_d*Ll*Llfd*Llkq1*Lmd^2*PL*i_fd*omega*omega_b^2*cos(delta) - I_d*Ll*Llfd*Llkq1*Lmd^2*PL*i_kd*omega*omega_b^2*cos(delta) - I_d*Ll*Llkd*Llkq1*Lmd^2*PL*i_fd*omega*omega_b^2*cos(delta) - I_d*Ll*Llkd*Llkq1*Lmd^2*PL*i_kd*omega*omega_b^2*cos(delta) - I_d*Llfd*Llkd*Llkq1*Lmd^2*PL*i_fd*omega*omega_b^2*cos(delta) - I_d*Llfd*Llkd*Llkq1*Lmd^2*PL*i_kd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llfd*Lmd^2*Lmq*PL*i_fd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llfd*Lmd^2*Lmq*PL*i_kd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llkd*Lmd^2*Lmq*PL*i_fd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llkd*Lmd^2*Lmq*PL*i_kd*omega*omega_b^2*cos(delta) - 2*I_d*Llfd*Llkd*Lmd^2*Lmq*PL*i_fd*omega*omega_b^2*cos(delta) - 2*I_d*Llfd*Llkd*Lmd^2*Lmq*PL*i_kd*omega*omega_b^2*cos(delta) + 2*I_d^2*I_q*Ll*Llfd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*I_q*Ll*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llfd*Llkd*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*I_q*Llfd*Llkd*Llkq1*Lmd^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*I_q*Llfd*Llkd*Llkq1*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llfd*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 4*I_d^2*I_q*Ll*Llfd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llkd*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 4*I_d^2*I_q*Ll*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 4*I_d^2*I_q*Llfd*Llkd*Lmd^2*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*I_q*Llfd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d^2*I_q*Llkd*Llkq1*Lmd*Lmq^2*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 2*I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega*omega_b^2*cos(delta)^2 - 4*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*cos(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - 2*I_d*I_q^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + I_d*I_q^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 + I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*cos(delta)^2 - I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Llfd*Llkd*Llkq1*Lmd*PL*Rs*omega_b^2*cos(delta)*sin(delta) + I_d*I_q*Llfd*Llkd*Llkq1*Lmq*PL*Rs*omega_b^2*cos(delta)*sin(delta) - 2*I_d*I_q*Llfd*Llkd*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)*sin(delta) + I_d*I_q*Llfd*Llkq1*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)*sin(delta) + I_d*I_q*Llkd*Llkq1*Lmd*Lmq*PL*Rs*omega_b^2*cos(delta)*sin(delta) - 2*I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega*omega_b^2*sin(delta)^2 - 2*I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b^2*sin(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 + I_d*I_q^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - 2*I_d*I_q^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 - I_d*I_q^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b*sin(delta)^2 - I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd*Lmq*V_q*omega_b*omega_s*sin(delta)^2 + I_d*I_q*Ll*Llfd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*cos(delta) + I_d*I_q*Ll*Llfd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*cos(delta) + I_d*I_q*Ll*Llkd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*cos(delta) + I_d*I_q*Ll*Llkd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*cos(delta) + I_d*I_q*Llfd*Llkd*Llkq1*Lmd^2*V_q*i_fd*omega*omega_b^2*cos(delta) + I_d*I_q*Llfd*Llkd*Llkq1*Lmd^2*V_q*i_kd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llfd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llfd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llkd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llkd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Llfd*Llkd*Lmd^2*Lmq*V_q*i_fd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Llfd*Llkd*Lmd^2*Lmq*V_q*i_kd*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*i_kq2*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*i_kq2*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*i_kq1*omega*omega_b^2*cos(delta) - I_d^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*i_kq2*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llfd*Llkd*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llfd*Llkd*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d*I_q*Llfd*Llkd*Llkq1*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Llfd*Llkd*Llkq1*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llfd*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llfd*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llkd*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llkd*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d*I_q*Llfd*Llkq1*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Llfd*Llkq1*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d*I_q*Llkd*Llkq1*Lmd*Lmq^2*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Llkd*Llkq1*Lmd*Lmq^2*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*i_fd*omega*omega_b^2*sin(delta) + I_d^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*i_kd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*i_fd*omega*omega_b^2*sin(delta) + 2*I_d^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*i_kd*omega*omega_b^2*sin(delta) + 2*I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)^2 + 4*I_d*I_q^2*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)^2 + I_d*I_q^2*Llfd*Llkd*Llkq1*Lmd*Rs*V_q*omega_b^2*cos(delta)*sin(delta) - I_d*I_q^2*Llfd*Llkd*Llkq1*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + 2*I_d*I_q^2*Llfd*Llkd*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) - I_d*I_q^2*Llfd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) - I_d*I_q^2*Llkd*Llkq1*Lmd*Lmq*Rs*V_q*omega_b^2*cos(delta)*sin(delta) + 2*I_d*I_q^2*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 + 2*I_d*I_q^2*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*sin(delta)^2 - 2*I_d^2*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) + 2*I_d^2*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b^2*cos(delta)*sin(delta) - I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega_b*omega_s*cos(delta)^2 - 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 - I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 + 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 + I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b*cos(delta)^2 + I_d*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*cos(delta)^2 - I_d*I_q*Ll*Llfd*Llkd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*cos(delta) - I_d*I_q*Ll*Llfd*Llkd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*cos(delta) - I_d*I_q*Ll*Llfd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*cos(delta) - I_d*I_q*Ll*Llfd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*cos(delta) - I_d*I_q*Ll*Llkd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*cos(delta) - I_d*I_q*Ll*Llkd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*cos(delta) - I_d*I_q*Llfd*Llkd*Lmd*Lmq*Rkq1*V_q*i_kq1*omega_b^2*cos(delta) - I_d*I_q*Llfd*Llkd*Lmd*Lmq*Rkq2*V_q*i_kq2*omega_b^2*cos(delta) - I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*PL*omega_b*omega_s*sin(delta)^2 - I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*PL*omega_b*omega_s*sin(delta)^2 - 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 - I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 + 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 + I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 - I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 - I_d*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*PL*omega*omega_b*sin(delta)^2 + I_d*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*PL*omega_b*omega_s*sin(delta)^2 + I_d*I_q*Ll*Llkd*Llkq1*Lmd*Rfd*V_q*i_fd*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llkd*Lmd*Lmq*Rfd*V_q*i_fd*omega_b^2*sin(delta) + I_d*I_q*Llkd*Llkq1*Lmd*Lmq*Rfd*V_q*i_fd*omega_b^2*sin(delta) + I_d*I_q*Ll*Llfd*Llkq1*Lmd*Rkd*V_q*i_kd*omega_b^2*sin(delta) + 2*I_d*I_q*Ll*Llfd*Lmd*Lmq*Rkd*V_q*i_kd*omega_b^2*sin(delta) + I_d*I_q*Llfd*Llkq1*Lmd*Lmq*Rkd*V_q*i_kd*omega_b^2*sin(delta) - I_d*Ll*Llfd*Llkd*Llkq1*Lmd*PL*i_fd*omega*omega_b^2*cos(delta) - I_d*Ll*Llfd*Llkd*Llkq1*Lmd*PL*i_kd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llfd*Llkd*Lmd*Lmq*PL*i_fd*omega*omega_b^2*cos(delta) - 2*I_d*Ll*Llfd*Llkd*Lmd*Lmq*PL*i_kd*omega*omega_b^2*cos(delta) - I_d*Ll*Llfd*Llkd*Llkq1*Lmq*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Ll*Llfd*Llkd*Llkq1*Lmq*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d*Ll*Llfd*Llkq1*Lmd*Lmq*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Ll*Llfd*Llkq1*Lmd*Lmq*PL*i_kq2*omega*omega_b^2*sin(delta) - I_d*Ll*Llkd*Llkq1*Lmd*Lmq*PL*i_kq1*omega*omega_b^2*sin(delta) - I_d*Ll*Llkd*Llkq1*Lmd*Lmq*PL*i_kq2*omega*omega_b^2*sin(delta) + 4*I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) + 8*I_d^2*I_q*Ll*Llfd*Llkd*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) - 4*I_d^2*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*omega*omega_b^2*cos(delta)*sin(delta) + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*i_fd*omega*omega_b^2*cos(delta) + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*V_q*i_kd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*V_q*i_fd*omega*omega_b^2*cos(delta) + 2*I_d*I_q*Ll*Llfd*Llkd*Lmd*Lmq*V_q*i_kd*omega*omega_b^2*cos(delta) + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*V_q*i_kq2*omega*omega_b^2*sin(delta) + I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*i_kq1*omega*omega_b^2*sin(delta) + I_d*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*V_q*i_kq2*omega*omega_b^2*sin(delta))/(I_d^2*I_q*Ll^2*Llfd*Llkd*Llkq1*cos(delta)^2 + I_d^2*I_q*Ll^2*Llfd*Llkq1*Lmd*cos(delta)^2 + I_d^2*I_q*Ll^2*Llkd*Llkq1*Lmd*cos(delta)^2 + 2*I_d^2*I_q*Ll^2*Llfd*Llkd*Lmq*cos(delta)^2 + 2*I_d^2*I_q*Ll^2*Llfd*Lmd*Lmq*cos(delta)^2 + 2*I_d^2*I_q*Ll^2*Llkd*Lmd*Lmq*cos(delta)^2 + I_d^2*I_q*Ll^2*Llfd*Llkd*Llkq1*sin(delta)^2 + I_d^2*I_q*Ll^2*Llfd*Llkq1*Lmd*sin(delta)^2 + I_d^2*I_q*Ll^2*Llkd*Llkq1*Lmd*sin(delta)^2 + 2*I_d^2*I_q*Ll^2*Llfd*Llkd*Lmq*sin(delta)^2 + 2*I_d^2*I_q*Ll^2*Llfd*Lmd*Lmq*sin(delta)^2 + 2*I_d^2*I_q*Ll^2*Llkd*Lmd*Lmq*sin(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*sin(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*sin(delta)^2 + 2*I_d^2*I_q*Ll*Llfd*Llkd*Lmd*Lmq*sin(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*sin(delta)^2 + I_d^2*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*sin(delta)^2 + I_d^2*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*sin(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmd*cos(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkd*Llkq1*Lmq*cos(delta)^2 + 2*I_d^2*I_q*Ll*Llfd*Llkd*Lmd*Lmq*cos(delta)^2 + I_d^2*I_q*Ll*Llfd*Llkq1*Lmd*Lmq*cos(delta)^2 + I_d^2*I_q*Ll*Llkd*Llkq1*Lmd*Lmq*cos(delta)^2 + I_d^2*I_q*Llfd*Llkd*Llkq1*Lmd*Lmq*cos(delta)^2);
dPdt = dPL;
dx = [dIdt; ddeltadt; domegadt;dV_qdt;dPdt];
if(any(isreal(dx))==0)
    error('Complex');
end
end
t = linspace(t0,tend,size(x,2));
plot(t,x(8,:),'b--','linewidth',2);hold on;
%plot(t1,x1(:,8),'g-.')
end